{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}
<div class="body normal">
    <h1 class="title">{{ page.title }}</h1>

    <div id="{{ page.title|slugify }}" class="exhibition-listing-item exhibition-title">
        <section class="exhibition-header">
            <section>
                <h2>{{ page.title }}</h2>
                <section class="exhibition-header__artists">
                    {% for artist in page.artists %}
                        <a href="{{ artist.url }}">
                            <p>{{ artist.name }}</p>
                        </a>
                    {% endfor %}
                </section>
            </section>
            <h3>{{ page.get_formatted_date_short }}</h3>
        </section>

        {% if page.body %}
            {% include_block page.body %}
        {% else %}
            <section class="exhibition-media">
                <section class="exhibition-card">
                    {% if page.featured_image %}
                        {% image page.featured_image width-1440 as img %}
                        <img src="{{ img.url }}" alt="The promotional showcard for the exhibition '{{ page.title }}' by This is a House Gallery."
                            class="quickview-item" width="{{ img.width }}" height="{{ img.height }}">
                    {% endif %}
                </section>

                <section class="exhibition-images">
                    {% if page.artworks %}
                        {% for artwork in page.artworks %}
                            <a href="{{ artwork.url }}" class="artwork-link">
                                {% if artwork.featured_image %}
                                    {% image artwork.featured_image width-1440 format-webp as img %}
                                    <img src="{{ img.url }}" alt="{{ artwork.title }}"
                                        role="img" width="{{ img.width }}" height="{{ img.height }}"
                                        loading="lazy" decoding="async">
                                {% endif %}
                            </a>
                        {% endfor %}
                    {% endif %}
                </section>
            </section>
        {% endif %}

        {% if page.description %}
        <div class="exhibition-description rich-text-block">
            {{ page.description|richtext }}
        </div>
        {% endif %}

        {% if page.exhibition_gallery %}
            <div class="exhibition-gallery-section">
                <h3>Exhibition Gallery</h3>
                {% include page.exhibition_gallery.get_template with gallery=page.exhibition_gallery %}
            </div>
        {% endif %}

        {% if page.opening_gallery %}
            <div class="opening-gallery-section">
                <h3>Opening Gallery</h3>
                {% include page.opening_gallery.get_template with gallery=page.opening_gallery %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
